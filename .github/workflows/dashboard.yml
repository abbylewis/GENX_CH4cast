on:
  workflow_dispatch:
  schedule:
  - cron: "0 11 * * *"

jobs:
  build:
    runs-on: ubuntu-latest
    container:
      image: rocker/tidyverse:4.2
      
    steps:
    - name: Checkout repo
      uses: actions/checkout@v4
      
    - name: run_dashboard
      run: |
        install.packages(c("shiny", "rsconnect"), type = "binary"))
        Rscript -e "rsconnect::setAccountInfo(name='aslewis', token=${{secrets.TOKEN}}, secret=${{secrets.SECRET}})"
        Rscript ./dashboard lightweight/run_dashboard.R
